config {
type: "table",
schema: "raw_vault",
tags: ["business_vault", "monthly_bookings"]
}
 
SELECT SeatClass,ROUND(AVG(Amount))
FROM ${ref("LINK_BOOKING_PAYMENT_DETAILS")} LBP
JOIN ${ref("SAT_BOOKING_DETAILS_SJ")} SB
ON (LBP.HK_BookingID = SB.HK_BookingID)
JOIN ${ref("SAT_PAYMENT_SJ")} SP
ON (LBP.HK_PaymentID = SP.HK_PaymentID)
GROUP BY 1