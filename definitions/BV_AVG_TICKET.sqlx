config {
type: "table",
schema: "raw_vault",
tags: ["business_vault", "monthly_bookings"]
}
 
SELECT SeatClass,ROUND(AVG(Amount))
FROM ${ref("LINK_BOOKING_PAYMENT_DETAILS")} LB
JOIN ${ref("SAT_BOOKING_DETAILS_SJ")} SB
ON (LB.HK_BookingID = SB.HK_BookingID)
LEFT JOIN ${ref("SAT_PAYMENT_SJ")} SP
ON (LB.HK_PaymentID = SP.HK_PaymentID)
WHERE LB.REC_SRC = 'SJ_BOOKING_DETAILS'
GROUP BY 1