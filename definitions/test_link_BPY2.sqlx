config {
  type: "table",
  schema: "raw_vault",
  tags: ["link"]
}

SELECT
  BOOKINGID AS HK_BOOKINGID,
  ${ref("AI_PAYMENT")}.PAYMENTID AS HK_PAYMENTID,
  CURRENT_TIMESTAMP() AS LOAD_DTS,
  'AI_AIRPORT_DETAILS' AS REC_SRC
FROM ${ref("AI_BOOKING_DETAILS")}
LEFT JOIN ${ref("AI_PAYMENT")}
ON ${ref("AI_BOOKING_DETAILS")}.PAYMENTID = ${ref("AI_PAYMENT")}.PAYMENTID
WHERE BOOKINGID IS NOT NULL AND ${ref("AI_PAYMENT")}.PAYMENTID IS NOT NULL
GROUP BY BOOKINGID,${ref("AI_PAYMENT")}.PAYMENTID