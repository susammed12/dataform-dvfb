config {
  type: "table",
  schema: "raw_vault",
  tags: ["link"]
}

SELECT
  MD5(BOOKINGID) AS HK_BOOKINGID,
  MD5(PAYMENTID) AS HK_PASSENGERID,
  CURRENT_TIMESTAMP() AS LOAD_DTS,
  REC_SRC
FROM ${ref("BOOKING_PAYMENT")}
WHERE BOOKINGID IS NOT NULL AND PAYMENTID IS NOT NULL
GROUP BY BOOKINGID,PAYMENTID,REC_SRC