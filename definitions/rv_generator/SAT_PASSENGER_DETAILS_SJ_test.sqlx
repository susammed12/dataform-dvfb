config {
  type: "table",
  schema: "raw_vault",
  tags: ["satellite"]
}

SELECT
  MD5(PassengerID) AS HK_PassengerID,
  MD5(CONCAT(COALESCE(CAST(FirstName AS STRING), ''), '|', COALESCE(CAST(LastName AS STRING), ''), '|', COALESCE(CAST(DOB AS STRING), ''), '|', COALESCE(CAST(Email AS STRING), ''), '|', COALESCE(CAST(MobileNumber AS STRING), ''), '|', COALESCE(CAST(CreatedDateTime AS STRING), ''), '|', COALESCE(CAST(LastupdateDateTime AS STRING), ''))) AS HASHDIFF,
  FirstName,
  LastName,
  DOB,
  Email,
  MobileNumber,
  CreatedDateTime,
  LastupdateDateTime,
  CURRENT_TIMESTAMP() AS LOAD_DTS,
  'SJ_PASSENGER_DETAILS' AS REC_SRC
FROM ${ref("SJ_PASSENGER_DETAILS")}
WHERE PassengerID IS NOT NULL